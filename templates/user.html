<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¹Ø¶Ùˆ - Ù†Ø§Ø¯ÙŠ Ù…Ø¯ÙŠØ³ÙŠØ³Ø©</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Cairo&display=swap');

body {
    font-family: 'Cairo', sans-serif;
    background: #f2f0ec;
    margin: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* ===== Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ ===== */
.top-bar{
    width:100%;
    max-width:900px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:15px;
}

.balance-box{
    background:#7a0000;
    color:#fff;
    padding:10px 15px;
    border-radius:12px;
    display:flex;
    align-items:center;
    gap:8px;
    box-shadow:0 5px 15px rgba(0,0,0,.3);
}

.balance-box span{
    font-weight:bold;
}

.top-actions a{
    text-decoration:none;
    margin-left:8px;
    padding:8px 15px;
    background:#333;
    color:#fff;
    border-radius:8px;
}

/* ===== Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ===== */
.menu{
    position:relative;
}

.menu button{
    padding:8px 15px;
    border:none;
    border-radius:8px;
    background:#7a0000;
    color:#fff;
    cursor:pointer;
}

.menu-content{
    display:none;
    position:absolute;
    top:40px;
    right:0;
    background:#fff;
    box-shadow:0 10px 25px rgba(0,0,0,.25);
    border-radius:10px;
    overflow:hidden;
    z-index:99;
}

.menu-content a{
    display:block;
    padding:10px 15px;
    color:#000;
    text-decoration:none;
    border-bottom:1px solid #eee;
}

.menu-content a:hover{
    background:#f2f0ec;
}

.menu:hover .menu-content{
    display:block;
}

/* ===== Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© ===== */
#pdfArea {
    width: 100%;
    max-width: 600px;
    filter: blur(6px);
    pointer-events:none;
    transition:.3s;
}

/* Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙˆÙƒØ³ */
#pdfArea.clear{
    filter:none;
    pointer-events:auto;
}

/* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© */
.user-card {
    position: relative;
    background: linear-gradient(145deg, #7a0000, #a00000);
    border-radius: 20px;
    padding: 20px;
    display: flex;
    gap: 15px;
    box-shadow: 0 15px 30px rgba(0,0,0,.4);
    overflow: hidden;
}

/* Ø´Ø¹Ø§Ø± Ù…Ø§Ø¦ÙŠ */
.user-card::after {
    content: "";
    position: absolute;
    inset: 0;
    background: url('static/images/logo.png') no-repeat center/320px;
    opacity: 0.20;
    z-index: 0;
}

.logo-top {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 85px;
    height: 85px;
    background: url('static/images/logo.png') no-repeat center/contain;
    z-index: 3;
}

.profile-column {
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 3;
}

.profile-box {
    width: 120px;
    height: 120px;
    border: 3px solid gold;
    border-radius: 16px;
    overflow: hidden;
    background: #fff;
}

.profile-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.identity-logo {
    width: 46px;
    height: 46px;
    margin: 8px 0;
    background: url('static/images/logo.png') no-repeat center/contain;
}

.qr-box img {
    width: 95px;
    height: 95px;
    border: 2px solid gold;
    border-radius: 8px;
    background: #fff;
}

.user-info {
    color: #fff;
    flex: 1;
    z-index: 3;
}

.user-info h2 {
    margin: 0 0 8px;
}

.user-info p {
    margin: 3px 0;
    font-size: 14px;
}

.verify-code {
    margin-top: 8px;
    padding: 6px 10px;
    background: rgba(255,255,255,.15);
    border-radius: 8px;
    font-size: 13px;
    display: inline-block;
}

.card-features {
    background: #fff;
    border-radius: 18px;
    margin-top: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,.25);
}

.card-features h3 {
    margin: 0;
    padding: 12px;
    background: #7a0000;
    color: #fff;
    text-align: center;
}

.card-features ul {
    padding: 15px 25px;
    margin: 0;
}

/* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… */
.control-buttons{
    margin-top:20px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
}

.control-buttons button{
    padding:12px 20px;
    border:none;
    border-radius:10px;
    background:#7a0000;
    color:#fff;
    cursor:pointer;
    box-shadow:0 5px 15px rgba(0,0,0,.3);
}

.download-btn{
    display:none;
}
</style>
</head>

<body>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
<div class="top-bar">

    <div class="balance-box">
        ğŸ’° Ø±ØµÙŠØ¯Ùƒ: <span id="balance">20</span> Ø¹Ù…Ù„Ø©
    </div>

    <div class="menu">
        <button>Ø§Ù„Ø®Ø¯Ù…Ø§Øª</button>
        <div class="menu-content">
            <a href="/worldcup">ğŸ† Ù…Ø´Ø§Ù‡Ø¯Ø© ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù… 2026</a>
            <a href="#">ğŸ  Ø´Ù‡Ø§Ø¯Ø© Ø³ÙƒÙ†</a>
            <a href="#">ğŸ“ Ø´Ù‡Ø§Ø¯Ø© Ù…Ø¯Ø±Ø³ÙŠØ©</a>
        </div>
    </div>

    <div class="top-actions">
        <a href="/">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a href="/logout">Ø®Ø±ÙˆØ¬</a>
    </div>

</div>

<div id="pdfArea">

    <div class="user-card">
        <div class="logo-top"></div>

        <div class="profile-column">
            <div class="profile-box">
                <img src="{{ user.photo_url }}">
            </div>
            <div class="identity-logo"></div>
            <div class="qr-box">
                <img src="{{ qr_code }}">
            </div>
        </div>

        <div class="user-info">
            <h2>{{ user.full_name }}</h2>
            <p>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: {{ user.username }}</p>
            <p>Ø±Ù‚Ù… Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©: {{ user.card_number }}</p>
            <p>Ø§Ù„Ù‡Ø§ØªÙ: {{ user.phone or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
            <p>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: {{ user.national_id or 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' }}</p>
            <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: {{ registration_date }}</p>
            <p>Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©: {{ expiry_date }}</p>
            <div class="verify-code">ÙƒÙˆØ¯ Ø§Ù„ØªØ­Ù‚Ù‚: {{ user.card_number }}-MD</div>
        </div>
    </div>

    <div class="card-features">
        <h3>Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©</h3>
        <ul>
            <li>Ø¨Ø·Ø§Ù‚Ø© Ø±Ø³Ù…ÙŠØ© Ù…Ø¹ØªÙ…Ø¯Ø©</li>
            <li>QR ØªØ­Ù‚Ù‚ Ù…Ø¨Ø§Ø´Ø±</li>
            <li>Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„ØªØ²ÙˆÙŠØ±</li>
        </ul>
    </div>
</div>

<div class="control-buttons">
    <button onclick="removeBlur()">Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙˆÙƒØ³ (10 Ø¹Ù…Ù„Ø§Øª)</button>
    <button class="download-btn" id="downloadBtn" onclick="downloadPDF()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© PDF</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
let balance = 20;

function removeBlur(){
    if(balance < 10){
        alert("âŒ Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙŠ");
        return;
    }
    balance -= 10;
    document.getElementById("balance").innerText = balance;
    document.getElementById("pdfArea").classList.add("clear");
    document.getElementById("downloadBtn").style.display="inline-block";
}

async function downloadPDF(){
    const { jsPDF } = window.jspdf;
    const area = document.getElementById('pdfArea');
    const rect = area.getBoundingClientRect();
    const canvas = await html2canvas(area,{scale:3,useCORS:true});
    const imgData = canvas.toDataURL('image/png',1.0);
    const pdf = new jsPDF({orientation:'landscape',unit:'px',format:[rect.width,rect.height]});
    pdf.addImage(imgData,'PNG',0,0,rect.width,rect.height);
    pdf.save('Ø¨Ø·Ø§Ù‚Ø©_Ø¹Ø¶Ùˆ_Ø±Ø³Ù…ÙŠØ©.pdf');
}
</script>

</body>
</html>

