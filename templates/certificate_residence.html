<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø´Ù‡Ø§Ø¯Ø© Ø³ÙƒÙ†</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600&display=swap" rel="stylesheet">

<style>
*{
    filter:none !important;
    backdrop-filter:none !important;
    transform:none !important;
}

body{
    font-family:'Cairo',sans-serif;
    background:#eee;
    padding:20px;
    display:flex;
    flex-direction:column;
    align-items:center;
}

/* ===== ØªÙ†Ø¨ÙŠÙ‡ ÙÙˆÙ‚ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ===== */
#alert-msg {
    max-width:1000px;
    width:100%;
    background:#ffeb3b;
    color:#000;
    font-weight:bold;
    text-align:center;
    padding:10px;
    margin-bottom:15px;
    border-radius:8px;
    font-size:16px;
    box-sizing:border-box;
}

/* ===== Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ===== */
#certificate{
    width:1000px;
    max-width:95%;
    height:560px;
    position:relative;
    overflow:hidden;
    background:#fff;
    box-sizing:border-box;
}

/* ===== Ø§Ù„Ø®Ù„ÙÙŠØ© ===== */
#certificate img.bg{
    position:absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
    object-fit:cover;
    pointer-events:none;
}

/* ===== Ø§Ù„Ø§Ø³Ù… ===== */
.name{
    position:absolute;
    top:200px;
    left:0;
    right:0;
    text-align:center;
    font-size:38px;
    font-weight:600;
    color:#1b7f6a;
}

/* ===== Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ ===== */
.national{
    position:absolute;
    top:290px;
    right:520px;
    font-size:22px;
    font-weight:600;
    color:#1b7f6a;
    direction:ltr;
    font-family:Arial, sans-serif;
}

/* ===== Ø§Ù„ØªØ§Ø±ÙŠØ® ===== */
.date{
    position:absolute;
    bottom:70px;
    right:30px;
    font-size:18px;
    font-weight:600;
    color:#1b7f6a;
    direction:ltr;
    font-family:Arial, sans-serif;
}

/* ===== Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ ===== */
button{
    margin-top:20px;
    padding:12px 25px;
    border:none;
    border-radius:10px;
    background:#1b7f6a;
    color:#fff;
    cursor:pointer;
    font-size:16px;
}

/* ===== Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ===== */
@media(max-width:768px){
    .name{
        font-size:28px;
        top:150px;
    }
    .national{
        font-size:18px;
        top:220px;
        right:50px;
    }
    .date{
        font-size:16px;
        bottom:50px;
        right:20px;
    }
    #certificate{
        height:auto;
        aspect-ratio:1000/560;
    }
    #alert-msg{
        font-size:14px;
    }
}
</style>
</head>

<body>

<!-- Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ÙÙˆÙ‚ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© -->
<div id="alert-msg">
ğŸ”” Ø§Ù„ØªØ­Ø°ÙŠØ±: Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ù„Ø§ ØªØ¹ØªÙ…Ø¯ Ø±Ø³Ù…ÙŠØ§Ù‹ Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ ØªÙˆÙ‚ÙŠØ¹ Ø±Ø¦ÙŠØ³ Ø§Ù„Ù„Ø¬Ù†Ø© Ø¹Ù„ÙŠÙ‡Ø§. ÙŠØ±Ø¬Ù‰ ØªÙ†Ø²ÙŠÙ„Ù‡Ø§ ÙˆØ·Ø¨Ø§Ø¹ØªÙ‡Ø§ Ù…Ù„ÙˆÙ†Ø© ÙˆØ¥Ø­Ø¶Ø§Ø±Ù‡Ø§ Ù„Ø±Ø¦ÙŠØ³ Ø§Ù„Ù„Ø¬Ù†Ø© Ù„Ø§Ø¹ØªÙ…Ø§Ø¯Ù‡Ø§.
</div>

<div id="certificate">
    <img src="/static/images/certificate_bg.jpg" class="bg">

    <div class="name" id="name">{{ user.full_name }}</div>
    <div class="national" id="nid">{{ user.national_id }}</div>
    <div class="date" id="date">{{ today }}</div>
</div>

<button onclick="downloadPDF()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© PDF</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
async function downloadPDF(){
    const { jsPDF } = window.jspdf;

    const cert = document.getElementById("certificate");
    const name = document.getElementById("name");
    const nid  = document.getElementById("nid");
    const date = document.getElementById("date");

    /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Øµ Ù…Ø¤Ù‚ØªÙ‹Ø§ */
    name.style.visibility =
    nid.style.visibility  =
    date.style.visibility = "hidden";

    const canvas = await html2canvas(cert,{
        scale:1,
        useCORS:true,
        backgroundColor:"#fff"
    });

    const imgData = canvas.toDataURL("image/png",1.0);

    const pdf = new jsPDF({
        orientation:"landscape",
        unit:"px",
        format:[1000,560]
    });

    pdf.addImage(imgData,"PNG",0,0,1000,560);

    /* ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù†ØµÙˆØµ Vector */
    pdf.setTextColor(27,127,106);
    pdf.setFont("Helvetica","bold");

    pdf.setFontSize(38);
    pdf.text(name.innerText, 500, 245, { align:"center" });

    pdf.setFontSize(22);
    pdf.text(nid.innerText, 540, 325);

    pdf.setFontSize(18);
    pdf.text(date.innerText, 820, 490);

    pdf.save("Ø´Ù‡Ø§Ø¯Ø©_Ø³ÙƒÙ†_Ù…Ø¯ÙŠØ³ÙŠØ³Ø©.pdf");

    /* Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù†Øµ */
    name.style.visibility =
    nid.style.visibility  =
    date.style.visibility = "visible";
}
</script>

</body>
</html>
