<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>شهادة سكن</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Cairo',sans-serif;
    background:#eee;
    padding:30px;
    display:flex;
    flex-direction:column;
    align-items:center;
}

/* مساحة الشهادة */
#certificate{
    width: 1000px;
    height: 560px;
    position: relative;
    background: url("/static/images/certificate_bg.jpg") no-repeat center/cover;
    box-shadow:0 10px 30px rgba(0,0,0,.3);
}

/* الاسم */
.name{
    position:absolute;
    top: 215px;   /* عدلها إذا لزم */
    left: 0;
    right: 0;
    text-align:center;
    font-size:36px;
    color:#1f8f7a;
    font-weight:700;
}

/* الرقم الوطني */
.national{
    position:absolute;
    top: 270px;  /* عدلها */
    right: 260px;
    font-size:18px;
    color:#333;
}

/* التاريخ */
.date{
    position:absolute;
    bottom: 95px;
    right: 170px;
    font-size:16px;
    color:#333;
}

/* زر */
button{
    margin-top:20px;
    padding:12px 25px;
    border:none;
    border-radius:10px;
    background:#1f8f7a;
    color:#fff;
    cursor:pointer;
}
</style>
</head>

<body>

<div id="certificate">
    <div class="name">{{ user.full_name }}</div>
    <div class="national">{{ user.national_id }}</div>
    <div class="date">{{ today }}</div>
</div>

<button onclick="downloadPDF()">تحميل الشهادة PDF</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>
async function downloadPDF(){
    const { jsPDF } = window.jspdf;
    const cert = document.getElementById("certificate");

    const canvas = await html2canvas(cert,{scale:3,useCORS:true});
    const img = canvas.toDataURL("image/png");

    const pdf = new jsPDF("landscape","px",[cert.offsetWidth, cert.offsetHeight]);
    pdf.addImage(img,"PNG",0,0,cert.offsetWidth, cert.offsetHeight);
    pdf.save("شهادة_سكن.pdf");
}
</script>

</body>
</html>
